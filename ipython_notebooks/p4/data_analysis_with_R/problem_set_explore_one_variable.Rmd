---
title: "problem_set:_explore_one_variable"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Loading libraries
library(ggplot2)
```


```{r}
#1a
diamonds
```
```{r}
#1b
ncol(diamonds)

#1c
str(diamonds)

#1d
?diamonds
```

*1. Quiz*
a) There are 53490 observations in the dataset
b) There are 10 variables in the dataset
c) there are 3 ordered factors in the dataset
d) D is the letter for the best diamond color


*2. Quiz: Price Histogram*
# Create a histogram of the price of
# all the diamonds in the diamond data set.

# TYPE YOUR CODE BELOW THE LINE
# =======================================
```{r}
summary(diamonds$price)

qplot(diamonds$price, binwidth = 400) + 
  scale_x_continuous(limits = c(0,20000), breaks = seq(0, 20000, 500))

```
The shape is left skewed. One of the bins, 400 to 800, is more than twice as large as the second largest bin. The mean of the sample is 3933, while the median is 2401. 

*4. Quiz: Diamond Counts*
a) How many diamonds cost less than $300?
```{r}
nrow(subset(diamonds, price < 500))
```
b) How many diamonds cost less than $250?
```{r}
nrow(subset(diamonds, price < 250))
```
c) How many diamonds cost $15000 or more?
```{r}
nrow(subset(diamonds, price >= 15000))

```

```{r}
subset(diamonds$price, diamonds$price > 300)
```

*5. Quiz: Cheaper Diamonds*
# Explore the largest peak in the
# price histogram you created earlier.

# Try limiting the x-axis, altering the bin width,
# and setting different breaks on the x-axis.

# There wonâ€™t be a solution video for this
# question so go to the discussions to
# share your thoughts and discover
# what other people find.

# You can save images by using the ggsave() command.
# ggsave() will save the last plot created.
# For example...
#                  qplot(x = price, data = diamonds)
#                  ggsave('priceHistogram.png')

# ggsave currently recognises the extensions eps/ps, tex (pictex),
# pdf, jpeg, tiff, png, bmp, svg and wmf (windows only).

```{r}
qplot(diamonds$price, binwidth = 25, color = I('black'), fill = I('#099DD9') ) + 
  scale_x_continuous(limits = c(350,1200), breaks = seq(300, 1200, 50))

#Rewriting the same in ggplot
ggplot(aes(x = price), data = diamonds) + 
  geom_histogram(binwidth = 25, color = I('black'), fill =  '#F79420', boundary = 1 ) +
  scale_x_continuous(limits = c(350,1201), breaks = seq(350, 1200, 50)) +
  xlab("Price (dollars)") + ylab("Number of diamonds")

ggsave('cheaper_diamonds_350-1200.png')

ggplot(aes(x = price), data = diamonds) + 
  geom_histogram(binwidth = 1, color = I('black'), fill =  '#F79420' ) +
  scale_x_continuous(limits = c(700,776), breaks = seq(700, 775, 5)) +
  xlab("Price (dollars)") + ylab("Number of diamonds")

ggsave('cheaper_diamonds_700-775.png')

#qplot(c(18,11,11,11,12,12,13,14,15,19,19,19,19,20,21,21), binwidth=1, color=I('black'), boundary = 1) + 
# scale_x_continuous(breaks = seq(10,20,2), limits = c(10,20))

nrow(subset(diamonds,price >= 350 & price < 375))
nrow(subset(diamonds,price > 1200 & price < 1225))
```

*6. Quiz: Price by  Cut Histograms*
# Break out the histogram of diamond prices by cut.

# You should have five histograms in separate
# panels on your resulting plot.

```{r}
ggplot(aes(x = price), data = diamonds) + 
  geom_histogram(binwidth = 10) + 
  scale_x_continuous() + #limits = c(0, 1000), breaks = seq(0, 1000, 50)) + 
  facet_wrap(~cut, ncol = 3)
```
The distributions are similar, except for 'Fair' cut. That doesn't tell us much, as the size of the stones are not taken into account.

*7. Quiz: Price by Cut*
a) Which cut has the highest priced diamond?
```{r}
#method 1: If few enough categories, just look at the summary output
by(diamonds$price, diamonds$cut, summary)
#NOTE: max is rounded

#method 2:
head(diamonds[with(diamonds,order(-price)),])

#method 3:
diamonds[which.max(diamonds$price),]
```
Premium cut has the highest priced diamond with a price of $18823.

b) Which cut has the lowest priced diamond?
```{r}
head(diamonds[with(diamonds,order(price)),])

#Alternative method (will not find both)
diamonds[which.min(diamonds$price),]
```
Ideal and Premium cuts both have a diamond priced at $326, which is the lowest price point.

c) Which cut has the lowest median price?
```{r}
by(diamonds$price, diamonds$cut, median)
```
Ideal has the lowest median price.

BONUS QUESTION (I answered this before C due to incorrect transcription)
d) Which cut has the median price?
```{r}
#Simplest solution, requires more steps
subset(diamonds, price == median(diamonds$price))

#More complex solution(?)
diamonds[which(diamonds$price == median(diamonds$price)),]
#To get single row
diamonds[which.min(abs(diamonds$price - median(diamonds$price))),]
#Get all rows, but just the unique cut values
unique(diamonds[which(diamonds$price == median(diamonds$price)),2])
```
All the categories: Premium, Ideal, Very Good, Good and Fair

*8. Quiz: Scales and multiple histograms*
# In the two last exercises, we looked at
# the distribution for diamonds by cut.

# Run the code below in R Studio to generate
# the histogram as a reminder.

# ===============================================================
```{r}
qplot(x = price, data = diamonds) + facet_wrap(~cut)
```
# ===============================================================

# In the last exercise, we looked at the summary statistics
# for diamond price by cut. If we look at the output table, the
# the median and quartiles are reasonably close to each other.

# diamonds$cut: Fair
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#     337    2050    3282    4359    5206   18570 
# ------------------------------------------------------------------------ 
# diamonds$cut: Good
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#     327    1145    3050    3929    5028   18790 
# ------------------------------------------------------------------------ 
# diamonds$cut: Very Good
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#     336     912    2648    3982    5373   18820 
# ------------------------------------------------------------------------ 
# diamonds$cut: Premium
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#     326    1046    3185    4584    6296   18820 
# ------------------------------------------------------------------------ 
# diamonds$cut: Ideal
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#     326     878    1810    3458    4678   18810 

# This means the distributions should be somewhat similar,
# but the histograms we created don't show that.

# The 'Fair' and 'Good' diamonds appear to have 
# different distributions compared to the better
# cut diamonds. They seem somewhat uniform
# on the left with long tails on the right.

# Let's look in to this more.

# Look up the documentation for facet_wrap in R Studio.
# Then, scroll back up and add a parameter to facet_wrap so that
# the y-axis in the histograms is not fixed. You want the y-axis to
# be different for each histogram.
```{r}
qplot(x = price, data = diamonds) + facet_wrap(~cut, scales = 'free_y')
#Same in ggplot
ggplot(aes(price), data = diamonds) + 
  geom_histogram() + 
  facet_wrap(~cut, ncol = 2, scales = 'free_y')
```

*Quiz 9: Price per carat by cut*
# Create a histogram of price per carat
# and facet it by cut. You can make adjustments
# to the code from the previous exercise to get
# started.

# Adjust the bin width and transform the scale
# of the x-axis using log10.

# Submit your final code when you are ready.
```{r}
#first attempt
ggplot(aes(log10(price)), data = diamonds) + 
  geom_histogram(binwidth = 0.1) + 
  facet_wrap(~cut)

#more proper way
ggplot(aes(price), data = diamonds) + 
  geom_histogram(binwidth = 0.1) + 
  scale_x_log10() + 
  facet_wrap(~cut) + 
  xlab("Price, logarithmic scale")

[NEXT: MAKE IT INTO PRICE PER CARAT, NOT PRICE]

```

